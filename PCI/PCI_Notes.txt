PCI Basics : Peripheral Componenet Interconnect
 1) The registers in the configuration space shall be used to see the memory requirement and IO resource requirement for a device.
 2) PCI and PCI-X speed is limited and along with the limited count of device per bus was the reason to move away from parallel to serial bus model.
 3) As PCI is progressing towards higher frequency for higher speeds, number of devices were reduced and distance between devices also shortened. This was due to reflected wave signalling. Eventhough 32 device may be connected to bus, practically 10-12 devices can only be connected in a bus due to reflected wave signalling.

Reflected Wave signalling.
 To Reduce the the power and cost, the PCI has used low power transmitter which transmits half the power which is required for PCI bus. When the wave reaches the termination due to infinite impedance the signal was reflected back. Due to additive nature of the signal the signal power level reached desired power level for the receiver. Normally this signal propagation delay should happen with in one clock cycle. This logic limits increase the signal progation  delay when more load is connected to bus or when length is more.

 To connect more loads in a bus PCI to PCI bridge to be used. When bridge is used then that bus is isolated from other buses hence each bus can hold 10-12 devices. Each bridge creates new isolated bus. Like this pci architecture allows 256 buses and 32 devices in each bus.

For communication with PCI device, PCI architecture has the following options,
 1) Programmed IO - When SW wants to communicate with PCI device it indicates the CPU to take data from memory into register and register to PCI device and vice versa. So this method uses 2 CPU cycle for single transaction and when the data becomes larger it occpies more CPU time for this transaction alone. Currently this method is used only when SW wants to comuunicate with PCI device ie for small data transfer.
 2) DMA - This is most popular for data transaction. Because there is one dedicated DMA engine to handle all memory transactions. CPU only has to configure the Memory address.
 3) Peer to peer - This is communication between two PCI device. This is not prefered since this method requires both device should follow same format for data understanding.

PCI Arbitration :
 Like I2C, PCI also has arbitor when one or more device wants to access the bus, device has to send req signal. Arbitor will decide the device ang give grant signal. This arbitration will happen during the previous master data execution state, so no clock cycle is waster for the arbitration.
 
PCI Error Handling :
 PCI data transactions are using even parity. When data trasnfer has odd parity, PCI will set PAR signal to make it even parity. In PCI there is address and data transaction phase. Where address will find the target device. Parity error in data phase is no proble, just simple retry logic would solve the proble. Where as parity error in address can not be identified as a result it would reach the false target device and system error will happen. Since this PERR and SERR was connected to NMI (Non maskable Interrupts) it would halt the system in PCI.

PCI Address Space :
 PCI has 3 address space. 
 1. Memory Space - Can support 32or64bit memory addressing.
 2. IO address Space - Can support 32bit memory addressing only. Since 0x86 processor uses 16bit for IO space max size of IO space is limited to 64Kb.
 3. Configuration Spcae - 256 Bytes. First 64 bytes contains header remainings byte are memory.

Memory and IO space is directly accecssbile by CPU, where as Configuration space is indirec access only in PCI. In IO address space there were two spaces reserved for configuration space address and data. For accessing the configuration space CPU first write address in the address space and Perform IO read or Write in data phase. This address is 32 bit long. This address will have the bus no, device no, function no and sub memory address. 

PCI configuration space details :
 PCI configuration space (256bytes) contains Header (64bytes) for device identification and 192bytes for optional functionality by the device. There are two types of header 1. Type 0 - Indicates end device, 2. Type 1 - Indicates PCI bridge. This device type is available as class code in header (dword 3, byte 2).
In enumuration process this type identification is the first one.

Reason for moving from PCI to PCI - X :
 Initially PCI supports 33MHz with 10-12 device with support of PCI bridge. To increase the speed clock speed was increased to 66MHz. Further the clock speed was not able to increase due to clock period could not be shortened further.
 
 In PCI-x PLL clock generation was introduced which shifts the output faster and at the target device inputs are being lateched reduces the setup time, thus increased speed to 133MHz.
 
 Problem in PCI-x :
 
